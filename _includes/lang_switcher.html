<ul class="lang-switcher">
  {% for lang in site.languages %}
    {% if lang == page.lang %}
      {% continue %}
    {% endif %}

    {% assign collection = site[lang] %}
    {% assign translated_page = collection | where: "ref", page.ref | first %}
    {% assign flag_url = site.flags[lang] %}

    {% if translated_page and flag_url %}
      <li>
        <a href="{{ translated_page.url | relative_url }}" class="{{ lang }}">
          <img src="{{ flag_url }}" alt="{{ lang }} flag" />
        </a>
      </li>
    {% endif %}
  {% endfor %}
</ul>
